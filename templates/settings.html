    <!-- Use main-content-wrapper to center the auth box -->
    <div class="main-content-wrapper auth-container">
        
        <!-- Display Flash Messages -->
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                <ul class="flash-messages">
                {% for category, message in messages %}
                    <li class="{{ category }}">{{ message }}</li>
                {% endfor %}
                </ul>
            {% endif %}
        {% endwith %}

        <!-- Form container -->
        <form method="POST" action="{{ url_for('settings') }}" class="glass-form auth-form">
            <h2 class="form-title">Settings</h2>

            <!-- Check if user logged in via Google (no password) -->
            {% if current_user.password_hash %}
                <h3>Change Password</h3>
                <div class="form-group">
                    <label for="old_password">Old Password:</label>
                    <input type="password" id="old_password" name="old_password" required>
                </div>
                
                <div class="form-group">
                    <label for="new_password1">New Password:</label>
                    <input type="password" id="new_password1" name="new_password1" required
                           minlength="8"
                           pattern="^(?!.*\s)(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[!@#$%^&*()_+=\-\[\]{};'\\:&quot;|,.<>\/?~`]).{8,}$"
                           title="Min 8 chars, 1 uppercase, 1 lowercase, 1 digit, 1 special char, no spaces.">
                    <small>Min 8 chars, 1 uppercase, 1 lowercase, 1 digit, 1 special char, no spaces.</small>
                </div>

                <div class="form-group">
                    <label for="new_password2">Confirm New Password:</label>
                    <input type="password" id="new_password2" name="new_password2" required minlength="8">
                </div>

                <button type="submit" onclick="this.disabled=true; this.innerText='Savingâ€¦';">
    Change Password
</button>

            {% else %}
                <h3>Change Password</h3>
                <p>You logged in using Google, so you don't have a local password to change.</p>
            {% endif %}

<div style="text-align:center;">
    <a class="popup-close-btn" onclick="closePopup()">Close</a>
</div>


        </form>
    </div>
