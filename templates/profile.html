

        <!-- ðŸ”½ MOVE YOUR EXISTING FORM INSIDE HERE ðŸ”½ -->

    <!-- Use main-content-wrapper to center the auth box -->
        
        <!-- Display Flash Messages -->
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                <ul class="flash-messages">
                {% for category, message in messages %}
                    <!-- Show 'success' messages in green, others in warning/danger colors -->
                    <li class="{{ category }}">{{ message }}</li>
                {% endfor %}
                </ul>
            {% endif %}
        {% endwith %}

        <!-- Form container -->
        <form method="POST" action="{{ url_for('profile') }}" class="glass-form auth-form">

            <h2 class="form-title">Profile Details</h2>


            <div class="form-group">
                <label for="name" class="required">Full Name</label>
                <!-- Pre-fill with current user's data -->
                <input type="text" id="name" name="name" required value="{{ current_user.name }}">
            </div>

            <div class="form-group">
                <label for="email" class="required">Email</label>
                <!-- Pre-fill and disable, as this is the login ID -->
                <input type="email" id="email" name="email" required value="{{ current_user.email }}" disabled>
                <small>Email cannot be changed.</small>
            </div>

            <div class="form-group">
    <label class="required">Mobile Number</label>

    {% if current_user.phone_number %}
        <!-- EXISTING PHONE â†’ LOCKED -->
        <div class="phone-display">
            <input type="text"
                   class="country-code"
                   value="{{ current_user.phone_number[:3] }}"
                   disabled>

            <input type="text"
                   class="phone-main"
                   value="{{ current_user.phone_number[3:] }}"
                   disabled>
        </div>

        <small>Mobile number cannot be changed.</small>

    {% else %}
        <!-- NO PHONE (Google login) â†’ ENABLE INPUT -->
        <input type="tel"
               name="phone"
               placeholder="Enter 10-digit mobile number"
               pattern="[6-9][0-9]{9}"
               maxlength="10"
               required>

        <small>Please add your mobile number.</small>
    {% endif %}
</div>

            <div class="form-group">
                <label class="required">Board</label>
                <select name="board" required class="{% if errors.board %}input-error{% endif %}">
    <option value="">Select Board</option>

    {% for b in ['CBSE','ICSE','State Board','IB','IGCSE','College'] %}
        <option value="{{ b }}"
            {% if current_user.board == b %}selected{% endif %}>
            {{ b }}
        </option>
    {% endfor %}

    <!-- âœ… COMBO OPTION -->
    <option value="CBSE-ICSE"
        {% if current_user.board == "CBSE-ICSE" %}selected{% endif %}>
        CBSE + ICSE (Combo)
    </option>
</select>

                {% if errors.board %}
                <div class="error-text">{{ errors.board }}</div>
                {% endif %}
            </div>

            
            <div class="form-group">
    <label for="grade" class="required">Grade</label>

    <select id="grade" name="grade" required>
        <option value="">Select Grade</option>

        {% for g in range(1, 13) %}
            <option value="{{ g }}"
                {% if current_user.grade and current_user.grade|int == g %}selected{% endif %}>
                {{ g }}
            </option>
        {% endfor %}
        <option value="10-12"
    {% if current_user.grade == "10-12" %}selected{% endif %}>
    Class 10â€“12 (Combo)
</option>

    </select>
</div>



            <!-- --- NEW FIELDS --- -->
            <div class="form-group">
                <label for="age" class="required">Age</label>
                <input type="number" id="age" name="age"
       placeholder="e.g., 25"
       value="{{ current_user.age or '' }}"
       min="1"
       required>

            </div>

            <div class="form-group">
    <label for="dob">Date of Birth (Optional)</label>


    <div style="display:flex; align-items:center;">
        <input
            type="date"
            id="dob"
            name="dob"
            value="{{ current_user.dob.strftime('%Y-%m-%d') if current_user.dob else '' }}"
            class="dob-input"
        >
    </div>
</div>




            <div class="form-group">
                <label for="city" class="required">City/Town (Nearest)</label>
                <input type="text" id="city" name="city"
       placeholder="e.g., Bengaluru"
       value="{{ current_user.city or '' }}"
       required>

            </div>
            
            <div class="form-group">
               <label for="postal_code" class="required">Postal/ZIP Code</label>
                <input type="text" id="postal_code" name="postal_code"
       placeholder="e.g., 560089"
       value="{{ current_user.postal_code or '' }}"
       required>
            </div>
            
            <div class="form-group">
                <label for="timezone">Timezone (Optional):</label>
                <select id="timezone" name="timezone">
                    <option value="" {% if not current_user.timezone %}selected{% endif %}>Select your timezone</option>
                    <option value="Asia/Kolkata" {% if current_user.timezone == 'Asia/Kolkata' %}selected{% endif %}>Asia/Kolkata (IST)</option>
                    <option value="Europe/London" {% if current_user.timezone == 'Europe/London' %}selected{% endif %}>Europe/London (GMT/BST)</option>
                    <option value="America/New_York" {% if current_user.timezone == 'America/New_York' %}selected{% endif %}>America/New_York (EST/EDT)</option>
                    <option value="America/Los_Angeles" {% if current_user.timezone == 'America/Los_Angeles' %}selected{% endif %}>America/Los_Angeles (PST/PDT)</option>
                    <!-- Add more common timezones as needed -->
                </select>
            </div>
            
            <div class="form-group checkbox-group">
    <label>
        <input type="checkbox" id="whatsapp_consent" name="whatsapp_consent" value="on"
               {% if current_user.whatsapp_consent %}checked{% endif %}>
        I agree to receive messages on WhatsApp.
    </label>
</div>

<div class="form-group checkbox-group" style="margin-top: 10px;">
    <label>
        <input type="checkbox" id="newsletter_consent" name="newsletter_consent" value="on"
               {% if current_user.newsletter_consent %}checked{% endif %}>
        Subscribe to newsletters, courses, and offers.
    </label>
</div>

            <!-- --- END NEW FIELDS --- -->


            <button type="submit">Update Profile</button>

<button type="button" class="secondary-btn" onclick="closePopup()">
    Close
</button>



</form>
