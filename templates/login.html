
<div class="main-content-wrapper auth-container">

    <form id="loginForm" method="post" action="/login" class="glass-form auth-form">

        <h1>Login</h1>

        <!-- LOGIN METHOD -->
<div class="form-group">
    <label>Login using:</label>

    <div class="login-methods">
        <label class="radio-option">
            <input type="radio" name="login_method" value="email" checked>
            <span>Email</span>
        </label>

        <label class="radio-option">
            <input type="radio" name="login_method" value="phone">
            <span>Phone Number</span>
        </label>
    </div>
</div>



        <!-- EMAIL / PHONE INPUT -->
        <div class="form-group">
            <label id="login-label">Email Address:</label>
            <input
                type="email"
                id="login_identifier"
                name="login_identifier"
                autocomplete="username"
                required
                placeholder="Enter your email"
            >
        </div>

        <!-- PASSWORD -->
        <!-- PASSWORD -->
<div class="form-group">
    <label>Password:</label>

    <div class="password-wrapper">
        <input
            type="password"
            id="login_password"
            name="password"
            placeholder="Enter your password"
            required
        >

        <button type="button"
                class="password-toggle"
                onclick="togglePassword('login_password', this)"
                aria-label="Toggle password visibility">

            <!-- EYE CLOSED (default) -->
            <svg class="eye-icon" viewBox="0 0 24 24">
                <path d="M2 12s4-7 10-7 10 7 10 7-4 7-10 7S2 12 2 12z"/>
                <line x1="3" y1="3" x2="21" y2="21"/>
            </svg>

        </button>
    </div>
</div>




        <button type="submit">Login</button>

        <div class="divider">OR</div>

<a href="/login/google" class="oauth-button google">
  Continue with Google
</a>

        <p class="auth-switch">
            Don't have an account?
            <a href="{{ url_for('register') }}">Register here</a>
        </p>

    </form>
</div>

<script>
function showError(msg) {
  let err = document.getElementById("formError");
  if (!err) {
    err = document.createElement("div");
    err.id = "formError";
    err.className = "flash error";
    err.style.marginTop = "10px";
    document.querySelector(".auth-form").prepend(err);
  }
  err.innerText = msg;
}
</script>
<script>
(function () {
  const form = document.getElementById("loginForm");
  if (!form) return;

  form.addEventListener("submit", async function (e) {
    e.preventDefault();

    const formData = new FormData(form);

    const res = await fetch("/login", {
      method: "POST",
      headers: {
        "X-Requested-With": "XMLHttpRequest"
      },
      body: formData,
      credentials: "same-origin"
    });

    const data = await res.json();

    if (data.success) {
      // ðŸ”¥ FORCE redirect to home
      window.location.href = "/";
    } else {
      alert(data.error || "Login failed");
    }
  });
})();
</script>



